     1: #include <PhilRoboKit_CoreLib_Macro.h>#include <soft_dac.h>
     2: 
     3: #define LED_UPDATE_INTERVAL    50
     4: 
     5: static uint16_t LoopTimer;
     6: static              uint8_t  LEDCounter, ADCOutValue = 0;
     7: static                          uint8_t  LogLookup[25] = {0,0,0,0,0,1,2,3,5,8,11,16,23,32,45,64,90,127,180,255,255,255,255,255,255};    
     8: static                          bool_t   LEDDirection;
     9: static uint16_t BlinkTimer;
    10: 
    11: void init()
    12: {
    13:         setupSoftDAC(SDAC0, LED1, ADCOutValue);
    14:     LoopTimer = getMs();     
    15:         //BlinkTimer = getMs();         // get time stamp
    16: }
    17: 
    18: void cycle()
    19: {
    20:   if(getElapsedMs(LoopTimer) >= LED_UPDATE_INTERVAL)
    21:   {
    22:     LoopTimer = getMs();                            // get time stamp
    23:  
    24:     if(LEDCounter >= 24)
    25:     {
    26:       LEDCounter=24;
    27:       LEDDirection = false;
    28:     }
    29:     else if(LEDCounter <= 1)
    30:     {
    31:       LEDDirection = true;
    32:       LEDCounter=1;
    33:     }
    34:     else
    35:     {
    36:       /* Do Nothing */
    37:     }
    38:     
    39:     if(LEDDirection)
    40:     {
    41:       LEDCounter++;
    42:     }
    43:     else
    44:     {
    45:       LEDCounter--;
    46:     }
    47:         
    48:     ADCOutValue = LogLookup[LEDCounter];
    49:         setSoftDAC(SDAC0, ADCOutValue); 
    50:   }
    51:   
    52:   //if(getElapsedMs(BlinkTimer) >= LED_UPDATE_INTERVAL)
    53:   //{
    54:         //  BlinkTimer = getMs();       // get time stamp
    55:         //  togglePin(LED2);
    56:   //}
    57: }
